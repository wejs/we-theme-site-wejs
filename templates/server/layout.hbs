<!DOCTYPE html>
<html>
  <head>
    <title>{{title}}</title>

    {{{render-metadata-tags}}}

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">

    <meta name="csrf-token" content="{{_csrf}}" />

    <script type="text/javascript" src="/public/project/client/bower_components/jquery/dist/jquery.min.js"></script>

    <script src="/public/project/client/bower_components/webcomponentsjs/webcomponents.js"></script>
    <script>
      window.Polymer = window.Polymer || {};
      window.Polymer.dom = 'shady';
    </script>

    {{!-- import polymer elements --}}

    {{!-- import we.js widgets --}}


    <link rel="import" href="/public/project/client/app/custom-elements/we-structure/we-main-menu.html">
    <link rel="import" href="/public/project/client/app/custom-elements/we-structure/we-menu-vertical.html">
    <link rel="import" href="/public/project/client/app/custom-elements/we-structure/we-user-menu.html">

    {{{render-stylesheet-tags}}}
  </head>
  <body unresolved class="fullbleed layout vertical" id="app">
    <div class="row regions">
      <div id="header" class="col col-md-12">
        <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/admin">{{title}}</a>
          </div>
          <!-- /.navbar-header -->

          <we-user-menu></we-user-menu>
          <we-main-menu></we-main-menu>
          <!-- /.navbar-top-links -->
          <div class="navbar-default sidebar" role="navigation">
            <div class="sidebar-nav navbar-collapse">
              <we-menu-vertical class="nav in" id="side-menu" menu="admin"></we-menu-vertical>
            </div>
            <!-- /.sidebar-collapse -->
          </div>
        </nav>
      </div>

      <div id="page-wrapper" style="min-height: 209px;">
        <div class="row">
          <we-region id="highlighted" class="col col-md-12"></we-region>
          <we-region id="content" class="col col-md-12">
            <noscript>{{{body}}}</noscript>
          </we-region>
          <script type="text/javascript">document.querySelector('noscript').remove();</script>
          <div id="footer" class="col col-md-12"></div>
        </div>
      </div>
    </div>

    {{{render-bootstrap-config}}}
    <script src="/public/project/client/bower_components/bootstrap/dist/js/bootstrap.js"></script>
    <script type="text/javascript" src="/public/project/client/bower_components/page/page.js"></script>
    <script type="text/javascript" src="/public/plugin/we-core/files/javascript/App.js"></script>
    <script type="text/javascript">window.App.initialize();</script>

    <script type="text/javascript">
      //Loads the correct sidebar on window load,
      //collapses the sidebar on window resize.
      // Sets the min-height of #page-wrapper to window size
      $(function() {
        $(window).bind("load resize", function() {
          topOffset = 50;
          width = (this.window.innerWidth > 0) ? this.window.innerWidth : this.screen.width;
          if (width < 768) {
            $('div.navbar-collapse').addClass('collapse');
            topOffset = 100; // 2-row-menu
          } else {
            $('div.navbar-collapse').removeClass('collapse');
          }

          height = ((this.window.innerHeight > 0) ? this.window.innerHeight : this.screen.height) - 1;
          height = height - topOffset;
          if (height < 1) height = 1;
          if (height > topOffset) {
            $("#page-wrapper").css("min-height", (height) + "px");
          }
        });

        var url = window.location;
        var element = $('ul.nav a').filter(function() {
          return this.href == url || url.href.indexOf(this.href) == 0;
        }).addClass('active').parent().parent().addClass('in').parent();
        if (element.is('li')) {
          element.addClass('active');
        }
      });
    </script>
  </body>
</html>