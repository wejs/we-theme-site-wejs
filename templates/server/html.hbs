<!DOCTYPE html>
<html>
<head>
  <title>{{title}}</title>

  {{{render-metadata-tags}}}

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <meta name="csrf-token" content="{{_csrf}}" />

  <script type="text/javascript" src="/public/project/client/bower_components/jquery/dist/jquery.min.js"></script>
  <link rel="stylesheet" type="text/css" href="/public/plugin/we-core/client/shared/libs/jquery-ui/jquery-ui.min.css">

  {{{render-stylesheet-tags}}}
</head>
<body>
  <div class="navbar navbar-default"><div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      {{#link-to 'main.index' class="navbar-brand"}}{{appName}}{{/link-to}}
    </div>

    {{we-menu 'main'}}

    {{!-- {{{template 'user/usermenu'}}} --}}

    <div class="sidebar-nav navbar-collapse">
      <we-menu-vertical class="nav in" id="side-menu" menu="admin"></we-menu-vertical>
    </div>
  </div></div>

  {{{layoutHtml}}}

  {{{render-bootstrap-config}}}
  <script type="text/javascript" src="/public/plugin/we-core/client/shared/libs/jquery-ui/jquery-ui.min.js"></script>
  <script src="/public/project/client/bower_components/bootstrap/dist/js/bootstrap.js"></script>
  <script type="text/javascript" src="/public/project/client/bower_components/page/page.js"></script>
  <script type="text/javascript" src="/public/plugin/we-core/files/javascript/we.js"></script>
  <script type="text/javascript">window.we.initialize();</script>

  <script type="text/javascript">
    //Loads the correct sidebar on window load,
    //collapses the sidebar on window resize.
    // Sets the min-height of #page-wrapper to window size
    $(function() {
      $(window).bind("load resize", function() {
        topOffset = 50;
        width = (this.window.innerWidth > 0) ? this.window.innerWidth : this.screen.width;
        if (width < 768) {
          $('div.navbar-collapse').addClass('collapse');
          topOffset = 100; // 2-row-menu
        } else {
          $('div.navbar-collapse').removeClass('collapse');
        }

        height = ((this.window.innerHeight > 0) ? this.window.innerHeight : this.screen.height) - 1;
        height = height - topOffset;
        if (height < 1) height = 1;
        if (height > topOffset) {
          $("#page-wrapper").css("min-height", (height) + "px");
        }
      });

      var url = window.location;
      var element = $('ul.nav a').filter(function() {
        return this.href == url || url.href.indexOf(this.href) == 0;
      }).addClass('active').parent().parent().addClass('in').parent();
      if (element.is('li')) {
        element.addClass('active');
      }
    });
  </script>
</body>
</html>